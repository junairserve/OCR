<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>製造番号 紐づけ（OCR）</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar__title">
      <div class="brand">製造番号 紐づけ（OCR）</div>
      <div class="hint">①本体銘板 → ②基板番号 → ③保存</div>
    </div>
    <div class="topbar__actions">
      <button id="btnStartCam" class="btn btn--ghost">▶ カメラ</button>
      <button id="btnStopCam" class="btn btn--ghost">■ 停止</button>
      <button id="btnTorch" class="btn btn--ghost" disabled>💡</button>
    </div>
  </header>

  <main class="main">
    <section class="cameraCard">
      <div class="camWrap">
        <video id="video" playsinline></video>
        <canvas id="canvas" class="hidden"></canvas>
        <div class="reticle" aria-hidden="true">
          <div class="reticle__box"></div>
          <div class="reticle__label">この枠に「SN:00000000」または基板番号を入れて撮影</div>
        </div>
      </div>

      <div class="quickActions">
        <button id="btnCaptureBody" class="btn btn--primary btn--xl">📷 本体を撮影（SN）</button>
        <button id="btnCapturePcb" class="btn btn--primary btn--xl">📷 基板を撮影（PCB）</button>
      </div>

      <div class="results">
        <div class="resultBox">
          <div class="resultLabel">本体（SN）</div>
          <div id="bodySn" class="resultValue">—</div>
          <div id="bodyWarn" class="warn"></div>
          <button id="btnClearBody" class="btn btn--ghost btn--wide">クリア</button>
        </div>

        <div class="resultBox">
          <div class="resultLabel">基板（PCB）</div>
          <div id="pcbId" class="resultValue">—</div>
          <div id="pcbWarn" class="warn"></div>
          <button id="btnClearPcb" class="btn btn--ghost btn--wide">クリア</button>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>保存</h2>

      <div class="grid2">
        <label class="field">
          <span>作業区分</span>
          <select id="workType">
            <option value="組立">組立</option>
            <option value="検査">検査</option>
            <option value="基板交換">基板交換</option>
            <option value="修理">修理</option>
            <option value="その他">その他</option>
          </select>
        </label>

        <label class="field">
          <span>作業者</span>
          <input id="operator" type="text" placeholder="例：山田" autocomplete="name" />
        </label>
      </div>

      <label class="field">
        <span>備考（任意）</span>
        <input id="note" type="text" placeholder="例：外観OK" />
      </label>

      <div class="statusRow">
        <div id="saveStatus" class="status"></div>
      </div>

      <details class="help">
        <summary>設定（必須：GAS URL）</summary>
        <div class="grid2">
          <label class="field">
            <span>SN桁数</span>
            <input id="snDigits" type="number" min="4" max="20" value="8"/>
          </label>
          <label class="field">
            <span>解像度</span>
            <select id="resolution">
              <option value="1280x720">1280×720（推奨）</option>
              <option value="1920x1080">1920×1080（高精細）</option>
              <option value="640x480">640×480（軽量）</option>
            </select>
          </label>
        </div>
        <label class="field">
          <span>GAS Webhook URL</span>
          <input id="gasUrl" type="url" placeholder="https://script.google.com/macros/s/....../exec" />
        </label>
        <div class="row">
          <button id="btnSaveSettings" class="btn btn--ghost btn--wide">設定を保存</button>
        </div>
        <p class="tiny">※設定は端末内（LocalStorage）に保存されます。</p>
      </details>
    </section>

    <div class="spacer"></div>
  </main>

  <nav class="bottomBar" aria-label="操作バー">
    <button id="btnSave" class="btn btn--primary btn--xl bottomBar__save" disabled>✅ 保存（紐づけ完了）</button>
    <button id="btnResetAll" class="btn btn--ghost bottomBar__reset">全リセット</button>
  </nav>

  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
